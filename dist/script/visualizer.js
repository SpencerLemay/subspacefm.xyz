window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;var visualizerStart=function(){if(1!=player.started){player.started=1;var e=new AudioContext,t=e.createAnalyser();e.createMediaElementSource(player.audioElement).connect(t),t.connect(e.destination);var a,r,n,o;new Uint8Array(t.frequencyBinCount);b();var i,c=document.getElementById("canvas"),d=c.width,l=c.height-2,u=800/12,f=[];e=c.getContext("2d"),(i=e.createLinearGradient(0,0,0,300)).addColorStop(n[0],n[1]),i.addColorStop(r[0],r[1]),i.addColorStop(a[0],a[1]),function c(){var s=new Uint8Array(t.frequencyBinCount);t.getByteFrequencyData(s);var y=Math.round(s.length/u);e.clearRect(0,0,d,l);for(var h=0;h<u;h++){var w=s[h*y];f.length<Math.round(u)&&f.push(w),e.fillStyle=o,w<f[h]?e.fillRect(12*h,l- --f[h],10,2):(e.fillRect(12*h,l-w,10,2),f[h]=w),e.fillStyle=i,e.fillRect(12*h,l-w+2,10,l)}2==player.started&&(e.clearRect(0,0,d,l),b(),i=null,(i=e.createLinearGradient(0,0,0,300)).addColorStop(n[0],n[1]),i.addColorStop(r[0],r[1]),i.addColorStop(a[0],a[1]),player.started=1),requestAnimationFrame(c)}()}function b(){switch(localStorage.getItem("theme")){case"theme-dark":n=[1,"#717e80"],r=[.5,"#3d4445"],a=[0,"#131b1c"],o="#131b1c";break;default:case"theme-light":n=[1,"#000"],r=[.5,"#777"],a=[0,"#bbb"],o="#000";break;case"theme-pink":n=[1,"#af9bbb"],r=[.5,"#c5bdc9"],a=[0,"#fff"],o="#fff";break;case"theme-green":n=[1,"#538740"],r=[.5,"#96b68d"],a=[0,"#fff"],o="#538740";break;case"theme-yellow":n=[1,"#723b04"],r=[.5,"#c89c4d"],a=[0,"#c89c4d"],o="#723b04"}}};$((function(){$("#play").click((function(){visualizerStart()}))}));