window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;var visualizerStart=function(){if(null==player.started){player.started=1;var e=new AudioContext,t=e.createAnalyser();e.createMediaElementSource(player.audioElement).connect(t),t.connect(e.destination);var n,a,o,r;new Uint8Array(t.frequencyBinCount);switch(localStorage.getItem("theme")){case"theme-dark":o=[1,"#717e80"],a=[.5,"#777"],n=[0,"#bbb"],r="#000";break;case"theme-light":o=[1,"#000"],a=[.5,"#777"],n=[0,"#bbb"],r="#000"}var i,l=document.getElementById("canvas"),c=l.width,d=l.height-2,u=r,w=800/12,y=[];e=l.getContext("2d"),(i=e.createLinearGradient(0,0,0,300)).addColorStop(o[0],o[1]),i.addColorStop(a[0],a[1]),i.addColorStop(n[0],n[1]),function n(){var a=new Uint8Array(t.frequencyBinCount);t.getByteFrequencyData(a);var o=Math.round(a.length/w);e.clearRect(0,0,c,d);for(var r=0;r<w;r++){var l=a[r*o];y.length<Math.round(w)&&y.push(l),e.fillStyle=u,l<y[r]?e.fillRect(12*r,d- --y[r],10,2):(e.fillRect(12*r,d-l,10,2),y[r]=l),e.fillStyle=i,e.fillRect(12*r,d-l+2,10,d)}requestAnimationFrame(n)}()}};$((function(){$("#play").click((function(){visualizerStart()}))}));