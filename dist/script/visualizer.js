window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;var visualizerStart=function(){if(null==player.started){player.started=1;var e=new AudioContext,t=e.createAnalyser();e.createMediaElementSource(player.audioElement).connect(t),t.connect(e.destination);var a,n,r,i;new Uint8Array(t.frequencyBinCount);switch(localStorage.getItem("theme")){case"theme-dark":r=[1,"#717e80"],n=[.5,"#3d4445"],a=[0,"#131b1c"],i="#131b1c";break;default:case"theme-light":r=[1,"#000"],n=[.5,"#777"],a=[0,"#bbb"],i="#000";break;case"theme-pink":r=[1,"#af9bbb"],n=[.5,"#c5bdc9"],a=[0,"#fff"],i="#fff"}var o,l=document.getElementById("canvas"),c=l.width,d=l.height-2,u=i,f=800/12,h=[];e=l.getContext("2d"),(o=e.createLinearGradient(0,0,0,300)).addColorStop(r[0],r[1]),o.addColorStop(n[0],n[1]),o.addColorStop(a[0],a[1]),function a(){var n=new Uint8Array(t.frequencyBinCount);t.getByteFrequencyData(n);var r=Math.round(n.length/f);e.clearRect(0,0,c,d);for(var i=0;i<f;i++){var l=n[i*r];h.length<Math.round(f)&&h.push(l),e.fillStyle=u,l<h[i]?e.fillRect(12*i,d- --h[i],10,2):(e.fillRect(12*i,d-l,10,2),h[i]=l),e.fillStyle=o,e.fillRect(12*i,d-l+2,10,d)}requestAnimationFrame(a)}()}};$((function(){$("#dark").click((function(){visualizerStart()})),$("#play").click((function(){visualizerStart()}))}));