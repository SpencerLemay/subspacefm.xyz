window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;var visualizerStart=function(){1!=player.started&&(player.started=0,delete e,delete t,delete a,delete d,delete l),player.started=1;var e=new AudioContext,t=e.createAnalyser(),a=e.createMediaElementSource(player.audioElement);a.connect(t),t.connect(e.destination);var n,r,i,o;new Uint8Array(t.frequencyBinCount);switch(localStorage.getItem("theme")){case"theme-dark":i=[1,"#717e80"],r=[.5,"#3d4445"],n=[0,"#131b1c"],o="#131b1c";break;default:case"theme-light":i=[1,"#000"],r=[.5,"#777"],n=[0,"#bbb"],o="#000";break;case"theme-pink":i=[1,"#af9bbb"],r=[.5,"#c5bdc9"],n=[0,"#fff"],o="#fff"}var l,d=document.getElementById("canvas"),c=d.width,u=d.height-2,f=o,s=800/12,y=[];e=d.getContext("2d"),(l=e.createLinearGradient(0,0,0,300)).addColorStop(i[0],i[1]),l.addColorStop(r[0],r[1]),l.addColorStop(n[0],n[1]),function a(){var n=new Uint8Array(t.frequencyBinCount);t.getByteFrequencyData(n);var r=Math.round(n.length/s);e.clearRect(0,0,c,u);for(var i=0;i<s;i++){var o=n[i*r];y.length<Math.round(s)&&y.push(o),e.fillStyle=f,o<y[i]?e.fillRect(12*i,u- --y[i],10,2):(e.fillRect(12*i,u-o,10,2),y[i]=o),e.fillStyle=l,e.fillRect(12*i,u-o+2,10,u)}requestAnimationFrame(a)}()};$((function(){$("#dark").click((function(){visualizerStart()})),$("#play").click((function(){visualizerStart()}))}));