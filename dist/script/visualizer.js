window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,window.gradient;var visualizerStart=function(){if(null==player.started){player.started=1;var e=new AudioContext,t=e.createAnalyser();e.createMediaElementSource(player.audioElement).connect(t),t.connect(e.destination);new Uint8Array(t.frequencyBinCount);var n=document.getElementById("canvas"),i=n.width,o=n.height-2,a=800/12,r=[];e=n.getContext("2d"),window.gradient=e.createLinearGradient(0,0,0,300),window.gradient.addColorStop(1,"#333"),window.gradient.addColorStop(.5,"#999"),window.gradient.addColorStop(0,"#fff"),function n(){var d=new Uint8Array(t.frequencyBinCount);t.getByteFrequencyData(d);var l=Math.round(d.length/a);e.clearRect(0,0,i,o);for(var u=0;u<a;u++){var c=d[u*l];r.length<Math.round(a)&&r.push(c),e.fillStyle="#000",c<r[u]?e.fillRect(12*u,o- --r[u],10,2):(e.fillRect(12*u,o-c,10,2),r[u]=c),e.fillStyle=undefined,e.fillRect(12*u,o-c+2,10,o)}requestAnimationFrame(n)}()}};$((function(){$("#play").click((function(){visualizerStart()}))}));